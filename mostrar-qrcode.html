<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>QR-Code</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #77000000;
  }

  canvas {
    width: 250px;
    height: 250px;
    image-rendering: pixelated;
    border: 0px solid #000;
    background: transparent;
  }
</style>
</head>
<body>

<canvas id="qrCanvas"></canvas>

<script src="qrious.min.js"></script>
<script>
  // Busca o dado do QR Code no Firebase Realtime Database
  fetch('https://projeto-aplicativo-android-default-rtdb.firebaseio.com/chave_pix.json')
    .then(response => response.json())
    .then(data => {
      // Trata o dado recebido, que pode ser string ou objeto JSON
      const qrValue = typeof data === 'string' ? data : JSON.stringify(data);

      const qr = new QRious({
        element: document.getElementById('qrCanvas'),
        value: qrValue,
        size: 500,
        level: 'H',
        padding: 0,
        foreground: '#000',
        background: 'transparent',
        backgroundAlpha: 0
      });

      const canvas = qr.canvas;
      const ctx = canvas.getContext('2d');

      const modules = Math.sqrt(qr._canvasRenderer.qrious.buffer.length);
      const moduleSize = Math.floor(qr.size / modules);
      const offset = Math.floor((qr.size - moduleSize * modules) / 2);

      ctx.clearRect(0, 0, qr.size, qr.size);
      ctx.fillStyle = qr.foreground;

      const buffer = qr._canvasRenderer.qrious.buffer;
      for (let y = 0; y < modules; y++) {
        for (let x = 0; x < modules; x++) {
          if (buffer[x + y * modules]) {
            ctx.fillRect(x * moduleSize + offset, y * moduleSize + offset, moduleSize, moduleSize);
          }
        }
      }
    })
    .catch(error => {
      console.error('Erro ao buscar dados do Firebase:', error);
    });
</script>

</body>
</html>
